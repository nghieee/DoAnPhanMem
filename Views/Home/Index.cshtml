@{
    ViewData["Title"] = "Home Page";
}

<style>
    .product-slide .card-text {
        height: 42px;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .product-slide .card-title {
        height: 72px;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
    }
</style>

<div class="main__slider">
    <div id="carouselExampleAutoplaying" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img class="d-block w-100" alt="" src="~/img/home-banner.png" />
            </div>
            <div class="carousel-item">
                <img class="d-block w-100" alt="" src="~/img/home-banner2.png" />
            </div>
            <div class="carousel-item">
                <img class="d-block w-100" alt="" src="~/img/home-banner3.png" />
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
    <div class="main__product container pt-5 pb-5">
        <h2 class="text-uppercase fw-500 text-center font-serif pt-5 p-4">Top sản phẩm bán chạy</h2>
        <div class="product-slide row row-cols-4">
            <div class="col">
                <div class="card border-0">
                    <img src="~/img/sanpham2.png" class="card-img-top" alt="" />
                    <div class="card-body text-center">
                        <h5 class="card-title fw-bold font-serif">Sữa Rửa Mặt Hoa Cúc Kiehl's Calendula Deep Cleansing Foaming Face Wash</h5>
                        <p class="card-text fst-italic font-14 font-serif">Sữa rửa mặt tạo bọt, giúp làm sạch sâu hiệu quả mà không gây khô da, đồng thời cung cấp các dưỡng chất cần thiết và làm dịu da.</p>
                    </div>
                    <div class="form-group d-flex justify-content-center align-items-center">
                        <label for="dropdownMenu" class="font-12 me-2">Chọn dung tích:</label>
                        <select class="form-control w-50" id="dropdownMenu">
                            <option value="75ml" data-price="550,000đ" selected>75ml</option>
                            <option value="230ml" data-price="1,000,000đ">230ml</option>
                            <option value="500ml" data-price="1,800,000đ">500ml</option>
                        </select>
                    </div>
                    <div class="font-18 text-center fw-500 pt-2 pb-2">
                        <span id="priceDisplay">550,000đ</span>
                    </div>
                    <button type="button" class="btn btn-outline-dark add-to-cart" data-name="Sữa Rửa Mặt Hoa Cúc Kiehl's" data-price="550000">THÊM VÀO GIỎ HÀNG</button>
                </div>
            </div>
            <div class="col">
                <div class="card border-0">
                    <img src="~/img/sanpham2.png" class="card-img-top" alt="" />
                    <div class="card-body text-center">
                        <h5 class="card-title fw-bold font-serif">Sữa Rửa Mặt Hoa </h5>
                        <p class="card-text fst-italic font-14 font-serif">Sữa rửâ</p>
                    </div>
                    <div class="form-group d-flex justify-content-center align-items-center">
                        <label for="dropdownMenu" class="font-12 me-2">Chọn dung tích:</label>
                        <select class="form-control w-50" id="dropdownMenu">
                            <option value="75ml" data-price="550,000đ" selected>75ml</option>
                            <option value="230ml" data-price="1,000,000đ">230ml</option>
                            <option value="500ml" data-price="1,800,000đ">500ml</option>
                        </select>
                    </div>
                    <div class="font-18 text-center fw-500 pt-2 pb-2">
                        <span id="priceDisplay">550,000đ</span>
                    </div>
                    <button type="button" class="btn btn-outline-dark add-to-cart" data-name="Sữa Rửa Mặt Hoa Cúc Kiehl's" data-price="550000">THÊM VÀO GIỎ HÀNG</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const dropdown = document.getElementById('dropdownMenu');
    const priceDisplay = document.getElementById('priceDisplay');
    const addToCartButton = document.querySelector('.add-to-cart');
    let cart = [];

    dropdown.addEventListener('change', function () {
        const selectedOption = dropdown.options[dropdown.selectedIndex];
        const price = selectedOption.getAttribute('data-price');
        priceDisplay.innerText = price;
        addToCartButton.setAttribute('data-price', price);
    });

    function addToCart(name, price) {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        cart.push({ name, price });
        localStorage.setItem('cart', JSON.stringify(cart));

        alert(name + " đã được thêm vào giỏ hàng!");
        updateCartDisplay();
    }

    function updateCartDisplay() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const cartCount = cart.length;

        document.querySelector('.cart-count').innerText = cartCount; 
    }

    document.addEventListener('DOMContentLoaded', updateCartDisplay);

    const addToCartButtons = document.querySelectorAll('.add-to-cart');
    addToCartButtons.forEach(button => {
        button.addEventListener('click', function () {
            const name = button.getAttribute('data-name');
            const price = button.getAttribute('data-price');
            addToCart(name, price);
        });
    });

</script>
